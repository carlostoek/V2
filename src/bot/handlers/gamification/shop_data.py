"""
Datos de ejemplo para el sistema de tienda de gamificaci√≥n.
Incluye las 4 categor√≠as obligatorias con items variados.
"""

# Configuraci√≥n de la tienda con 4 categor√≠as obligatorias
SHOP_CATEGORIES = {
    "especial": {
        "name": "üíã Contenido Especial",
        "description": "Fotos y videos exclusivos de Diana",
        "emoji": "üíã",
        "order": 1
    },
    "recompensas": {
        "name": "üéÅ Recompensas Virtuales",
        "description": "Badges, t√≠tulos y reconocimientos",
        "emoji": "üéÅ",
        "order": 2
    },
    "narrativa": {
        "name": "üîì Desbloqueos Narrativos",
        "description": "Fragmentos VIP y pistas exclusivas",
        "emoji": "üîì",
        "order": 3
    },
    "beneficios": {
        "name": "‚≠ê Beneficios Temporales",
        "description": "Multiplicadores y ventajas especiales",
        "emoji": "‚≠ê",
        "order": 4
    }
}

# Items disponibles por categor√≠a
SHOP_ITEMS = {
    "especial": [
        {
            "id": "foto_exclusiva_1",
            "name": "Foto Exclusiva #1",
            "description": "Una foto sensual y misteriosa de Diana en ambiente √≠ntimo",
            "price": 50,
            "type": "media",
            "rarity": "rare",
            "preview": "üì∏ Vista previa disponible",
            "level_required": 1
        },
        {
            "id": "video_personal_1",
            "name": "Video Personal de Diana",
            "description": "Un video personal donde Diana comparte pensamientos √≠ntimos",
            "price": 120,
            "type": "media",
            "rarity": "epic",
            "preview": "üé• 30 segundos de contenido premium",
            "level_required": 3
        },
        {
            "id": "foto_exclusiva_2",
            "name": "Sesi√≥n Fotogr√°fica Privada",
            "description": "Colecci√≥n de 5 fotos de una sesi√≥n privada de Diana",
            "price": 200,
            "type": "media_bundle",
            "rarity": "legendary",
            "preview": "üì∑ 5 fotos en alta calidad",
            "level_required": 5
        },
        {
            "id": "audio_susurro",
            "name": "Susurros de Diana",
            "description": "Audio √≠ntimo con la voz seductora de Diana",
            "price": 80,
            "type": "audio",
            "rarity": "rare",
            "preview": "üîä Audio de 2 minutos",
            "level_required": 2
        },
        {
            "id": "coleccion_completa",
            "name": "Colecci√≥n Completa Premium",
            "description": "Todo el contenido especial disponible hasta la fecha",
            "price": 500,
            "type": "bundle",
            "rarity": "mythic",
            "preview": "üéä +20 items premium",
            "level_required": 10,
            "discount": 30  # 30% descuento
        }
    ],
    
    "recompensas": [
        {
            "id": "badge_vip",
            "name": "Badge VIP Dorado",
            "description": "Un distintivo dorado que muestra tu estatus VIP",
            "price": 30,
            "type": "badge",
            "rarity": "common",
            "effect": "T√≠tulo visible en el perfil",
            "level_required": 1
        },
        {
            "id": "titulo_conquistador",
            "name": "T√≠tulo: Conquistador",
            "description": "T√≠tulo especial que aparece junto a tu nombre",
            "price": 45,
            "type": "title",
            "rarity": "rare",
            "effect": "Aparece como 'Conquistador [Nombre]'",
            "level_required": 2
        },
        {
            "id": "marco_perfil_diamante",
            "name": "Marco de Perfil Diamante",
            "description": "Marco brillante para destacar tu perfil",
            "price": 75,
            "type": "cosmetic",
            "rarity": "epic",
            "effect": "Marco visual en tu perfil",
            "level_required": 4
        },
        {
            "id": "titulo_leyenda",
            "name": "T√≠tulo: Leyenda de Diana",
            "description": "El t√≠tulo m√°s prestigioso disponible",
            "price": 150,
            "type": "title",
            "rarity": "legendary",
            "effect": "T√≠tulo especial con efectos visuales",
            "level_required": 7
        },
        {
            "id": "coleccion_badges",
            "name": "Colecci√≥n de Badges Tem√°ticos",
            "description": "Set de 10 badges con diferentes temas",
            "price": 100,
            "type": "badge_bundle",
            "rarity": "epic",
            "effect": "10 badges √∫nicos para coleccionar",
            "level_required": 5
        }
    ],
    
    "narrativa": [
        {
            "id": "fragmento_vip_1",
            "name": "Fragmento VIP: 'El Encuentro'",
            "description": "Escena exclusiva entre Diana y el protagonista",
            "price": 60,
            "type": "narrative_fragment",
            "rarity": "rare",
            "content": "Fragmento narrativo de 500+ palabras",
            "level_required": 3
        },
        {
            "id": "pista_misteriosa_1",
            "name": "Pista Misteriosa: 'La Llave'",
            "description": "Una pista crucial para entender el misterio de Diana",
            "price": 40,
            "type": "clue",
            "rarity": "common",
            "content": "Pista que desbloquea nueva rama narrativa",
            "level_required": 2
        },
        {
            "id": "final_alternativo",
            "name": "Final Alternativo Secreto",
            "description": "Un final completamente diferente para la historia",
            "price": 250,
            "type": "narrative_ending",
            "rarity": "mythic",
            "content": "Final exclusivo de 1000+ palabras",
            "level_required": 8
        },
        {
            "id": "backstory_diana",
            "name": "Historia Personal de Diana",
            "description": "Los secretos del pasado de Diana revelados",
            "price": 90,
            "type": "backstory",
            "rarity": "epic",
            "content": "Cap√≠tulo especial sobre Diana",
            "level_required": 4
        },
        {
            "id": "dialogo_intimo",
            "name": "Di√°logos √çntimos Exclusivos",
            "description": "Conversaciones profundas y personales con Diana",
            "price": 70,
            "type": "dialogue",
            "rarity": "rare",
            "content": "5 di√°logos √∫nicos no disponibles en la historia principal",
            "level_required": 3
        }
    ],
    
    "beneficios": [
        {
            "id": "multiplicador_2x_24h",
            "name": "Multiplicador x2 (24h)",
            "description": "Duplica todos los besitos ganados durante 24 horas",
            "price": 80,
            "type": "multiplier",
            "rarity": "rare",
            "duration_hours": 24,
            "multiplier": 2.0,
            "level_required": 2
        },
        {
            "id": "mision_extra",
            "name": "Misi√≥n Bonus Diaria",
            "description": "Una misi√≥n adicional por d√≠a durante una semana",
            "price": 100,
            "type": "mission_bonus",
            "rarity": "epic",
            "duration_days": 7,
            "effect": "Misi√≥n adicional cada d√≠a",
            "level_required": 3
        },
        {
            "id": "regalo_doble",
            "name": "Recompensa Diaria x2",
            "description": "Duplica la recompensa diaria por una semana",
            "price": 120,
            "type": "daily_bonus",
            "rarity": "epic",
            "duration_days": 7,
            "multiplier": 2.0,
            "level_required": 3
        },
        {
            "id": "acceso_vip_temp",
            "name": "Acceso VIP Temporal (3 d√≠as)",
            "description": "Acceso completo a contenido VIP por 3 d√≠as",
            "price": 150,
            "type": "vip_access",
            "rarity": "legendary",
            "duration_days": 3,
            "effect": "Acceso completo VIP",
            "level_required": 5
        },
        {
            "id": "multiplicador_mega",
            "name": "Mega Multiplicador x5 (2h)",
            "description": "Multiplica besitos por 5 durante 2 horas intensas",
            "price": 200,
            "type": "mega_multiplier",
            "rarity": "legendary",
            "duration_hours": 2,
            "multiplier": 5.0,
            "level_required": 6
        },
        {
            "id": "pack_beneficios",
            "name": "Pack de Beneficios Premium",
            "description": "Combinaci√≥n de varios multiplicadores y bonuses",
            "price": 300,
            "type": "benefit_bundle",
            "rarity": "mythic",
            "contents": ["multiplicador_2x_24h", "regalo_doble", "mision_extra"],
            "discount": 25,  # 25% descuento
            "level_required": 7
        }
    ]
}

# Configuraci√≥n de rareza y colores
RARITY_CONFIG = {
    "common": {
        "name": "Com√∫n",
        "color": "‚ö™",
        "emoji": "‚ö™"
    },
    "rare": {
        "name": "Raro",
        "color": "üîµ",
        "emoji": "üíé"
    },
    "epic": {
        "name": "√âpico",
        "color": "üü£",
        "emoji": "‚ú®"
    },
    "legendary": {
        "name": "Legendario",
        "color": "üü°",
        "emoji": "üëë"
    },
    "mythic": {
        "name": "M√≠tico",
        "color": "üî¥",
        "emoji": "‚≠ê"
    }
}

def get_item_by_id(item_id: str) -> dict:
    """
    Busca un item por su ID en todas las categor√≠as.
    
    Args:
        item_id: ID del item a buscar.
        
    Returns:
        Dict con el item encontrado o None si no existe.
    """
    for category, items in SHOP_ITEMS.items():
        for item in items:
            if item["id"] == item_id:
                item["category"] = category
                return item
    return None

def get_items_by_category(category: str, user_level: int = 1) -> list:
    """
    Obtiene items de una categor√≠a filtrados por nivel del usuario.
    
    Args:
        category: Categor√≠a de items.
        user_level: Nivel del usuario.
        
    Returns:
        Lista de items disponibles para el usuario.
    """
    if category not in SHOP_ITEMS:
        return []
    
    available_items = []
    for item in SHOP_ITEMS[category]:
        if item.get("level_required", 1) <= user_level:
            available_items.append(item)
    
    return available_items

def calculate_final_price(item: dict, user_data: dict = None) -> int:
    """
    Calcula el precio final de un item considerando descuentos.
    
    Args:
        item: Item del cual calcular el precio.
        user_data: Datos del usuario para descuentos especiales.
        
    Returns:
        Precio final del item.
    """
    base_price = item["price"]
    
    # Aplicar descuento del item si existe
    discount = item.get("discount", 0)
    if discount > 0:
        base_price = int(base_price * (1 - discount / 100))
    
    # Descuentos adicionales basados en el usuario podr√≠an ir aqu√≠
    # Por ejemplo: descuentos VIP, descuentos por nivel, etc.
    
    return base_price

def format_item_description(item: dict) -> str:
    """
    Formatea la descripci√≥n de un item para mostrar en el bot.
    
    Args:
        item: Item a formatear.
        
    Returns:
        Descripci√≥n formateada en markdown.
    """
    rarity_info = RARITY_CONFIG.get(item["rarity"], RARITY_CONFIG["common"])
    price = calculate_final_price(item)
    
    text = f"{rarity_info['emoji']} **{item['name']}**\n"
    text += f"_{item['description']}_\n\n"
    
    # Precio con descuento si aplica
    if item.get("discount", 0) > 0:
        original_price = item["price"]
        text += f"üí∞ ~~{original_price}~~ **{price} besitos** (-{item['discount']}%)\n"
    else:
        text += f"üí∞ **{price} besitos**\n"
    
    # Informaci√≥n adicional seg√∫n el tipo
    if "preview" in item:
        text += f"üëÅÔ∏è {item['preview']}\n"
    
    if "effect" in item:
        text += f"‚ö° {item['effect']}\n"
    
    if "duration_hours" in item:
        text += f"‚è∞ Duraci√≥n: {item['duration_hours']} horas\n"
    
    if "duration_days" in item:
        text += f"üìÖ Duraci√≥n: {item['duration_days']} d√≠as\n"
    
    if "level_required" in item and item["level_required"] > 1:
        text += f"üéØ Nivel requerido: {item['level_required']}\n"
    
    text += f"üè∑Ô∏è Rareza: {rarity_info['name']}\n"
    
    return text